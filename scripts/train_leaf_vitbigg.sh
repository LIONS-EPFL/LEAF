python3 train_AT_text_only.py \
    --save-frequency 1 \
    --zeroshot-frequency 1 \
    --report-to wandb \
    --wandb-project-name "datacomp_small" \
    --train-data 'path/to/datacomp/shards/{00000000..00001287}.tar' \
    --imagenet-val='path/to/imagenet/val' \
    --val-text-classification 'fancyzhx/ag_news' \
    --warmup 1400 \
    --batch-size=16 \
    --accum-freq=8 \
    --lr=1e-5 \
    --wd=1e-4 \
    --epochs=30 \
    --workers=8 \
    --model 'hf-hub:laion/CLIP-ViT-bigG-14-laion2B-39B-b160k' \
    --dataset-type webdataset \
    --train-num-samples 80000 \
    --val-num-samples 1024 \
    --k_adv 1 \
    --k_adv_test 1 \
    --n_charmer=50 \
    --n_charmer_test=20 \
    --n_val_imagenet 100  \
    --seed 1 \
    --custom_out_folder 'ViT-bigG_constrained_' \
    --constrain \